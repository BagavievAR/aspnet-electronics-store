@model WebApp.Models.Product

@{
    ViewData["Title"] = Model.Title;
}

<h2 class="mt-3">@Model.Title</h2>

@if (!string.IsNullOrEmpty(Model.ImageUrl))
{
    <img src="@Model.ImageUrl" class="img-fluid mb-3" alt="@Model.Title" />
}

<p class="text-muted">
    Категория: @Model.Category?.Name · Бренд: @Model.Brand?.Name
</p>

@if (!string.IsNullOrWhiteSpace(Model.Description))
{
    <p>@Model.Description</p>
}

<p class="fs-4 fw-bold">@Model.Price.ToString("N0") ₽</p>
<p>В наличии: @Model.Stock шт.</p>

<hr />

<div class="mt-3 d-flex gap-2">
    @* КОРЗИНА *@
    @if (User.Identity?.IsAuthenticated == true)
    {
        <form asp-controller="Cart" asp-action="Add" method="post" class="d-inline">
            @Html.AntiForgeryToken()
            <input type="hidden" name="productId" value="@Model.Id" />
            <button type="submit" class="btn btn-primary">
                Добавить в корзину
            </button>
        </form>
    }
    else
    {
        <a asp-controller="Account"
           asp-action="Login"
           asp-route-returnUrl="@Url.Action("Details","Product", new { id = Model.Id })"
           class="btn btn-primary">
            Войдите, чтобы добавить в корзину
        </a>
    }

    @* КНОПКИ ДЛЯ АДМИНА *@
    @if (User.Identity?.IsAuthenticated == true && User.IsInRole("Admin"))
    {
        <a class="btn btn-outline-secondary"
           asp-controller="Product"
           asp-action="Edit"
           asp-route-id="@Model.Id">
            Редактировать
        </a>

        <form asp-controller="Product"
              asp-action="Delete"
              asp-route-id="@Model.Id"
              method="post"
              class="d-inline"
              onsubmit="return confirm('Точно удалить товар?');">
            @Html.AntiForgeryToken()
            <button type="submit" class="btn btn-outline-danger">
                Удалить
            </button>
        </form>
    }

    <a class="btn btn-link" asp-controller="Catalog" asp-action="Index">
        ← Вернуться в каталог
    </a>
</div>
