@model WebApp.Models.CatalogPageVm

@{
    ViewData["Title"] = "Каталог";
}

<h2>Каталог</h2>

<p class="text-muted">
    Категории загружены из кэша: @Model.CategoriesGenerated.ToString("HH:mm:ss") <br />
    Бренды загружены из кэша: @Model.BrandsGenerated.ToString("HH:mm:ss")
</p>

<form method="get" class="row g-2 mb-3">
    <div class="col-md-3">
        <select name="categoryId" class="form-select">
            <option value="">Все категории</option>
            @foreach (var c in Model.Categories)
            {
                <option value="@c.Id" selected="@(Model.SelectedCategoryId == c.Id)">
                    @c.Name
                </option>
            }
        </select>
    </div>

    <div class="col-md-3">
        <select name="brandId" class="form-select">
            <option value="">Все бренды</option>
            @foreach (var b in Model.Brands)
            {
                <option value="@b.Id" selected="@(Model.SelectedBrandId == b.Id)">
                    @b.Name
                </option>
            }
        </select>
    </div>

    <div class="col-md-2">
        <input name="minPrice" value="@Model.MinPrice"
               class="form-control" placeholder="Мин. цена" />
    </div>
    <div class="col-md-2">
        <input name="maxPrice" value="@Model.MaxPrice"
               class="form-control" placeholder="Макс. цена" />
    </div>

    <div class="col-md-2 d-grid">
        <button class="btn btn-primary">Фильтровать</button>
    </div>
</form>

<div class="row row-cols-1 row-cols-md-3 g-3">
@foreach (var p in Model.Products)
{
    <div class="col">
        <div class="card h-100 product-card">
            @* Фото *@
            @if (!string.IsNullOrEmpty(p.ImageUrl))
            {
                <img src="@p.ImageUrl" class="card-img-top" alt="@p.Title" />
            }
            <div class="card-body">
                <h5 class="card-title">@p.Title</h5>
                <p class="card-text text-muted">
                    @p.Category?.Name · @p.Brand?.Name
                </p>
                <p class="fw-bold">@p.Price.ToString("N0") ₽</p>
                <a class="btn btn-outline-primary"
                   asp-controller="Product"
                   asp-action="Details"
                   asp-route-id="@p.Id">
                    Подробнее
                </a>
            </div>
        </div>
    </div>
}
</div>
